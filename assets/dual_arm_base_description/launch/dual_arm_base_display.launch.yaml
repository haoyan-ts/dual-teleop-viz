# dual_arm_base_display.launch.yaml
#
# It starts RViz, a robot_state_publisher, and a joint_state_publisher_gui
# to visualize a robot model described by a XACRO/URDF file.

launch:
  # Declare the launch arguments.
  # We use substitutions like `find-pkg-share` and `path-join-subst` which
  # are the YAML equivalents of FindPackageShare and PathJoinSubstitution.
  arguments:
    - name: "description_file"
      default_value: "$(var path-join-subst $(var find-pkg-share dual_arm_base_description) urdf dual_arm_base.xacro)"
      description: "URDF/XACRO description file (absolute path) with the robot."

    - name: "rviz_config_file"
      default_value: "$(var path-join-subst $(var find-pkg-share dual_arm_base_description) config display.rviz)"
      description: "RViz config file (absolute path) to use when launching rviz."

  # Define the list of nodes to be launched.
  nodes:
    # 1. Joint State Publisher GUI
    # Provides a GUI to manually control the robot's joint states.
    - package: "joint_state_publisher_gui"
      executable: "joint_state_publisher_gui"

    # 2. Robot State Publisher
    # Publishes the robot's state (TF transforms) based on the URDF
    # and the joint states from /joint_states topic.
    - package: "robot_state_publisher"
      executable: "robot_state_publisher"
      output: "both"
      parameters:
        # The 'robot_description' parameter is loaded by executing the 'xacro' command.
        # This is the YAML equivalent of the Command(...) substitution in Python.
        # It processes the XACRO file specified by the 'description_file' argument.
        - robot_description: "$(var command '$(var find-exec xacro) $(var description_file)')"

    # 3. RViz2
    # The visualization tool. It's launched with a specific configuration file.
    - package: "rviz2"
      executable: "rviz2"
      name: "rviz2"
      output: "log"
      # The '-d' argument tells RViz to load a specific configuration file.
      # We use the 'rviz_config_file' launch argument here.
      arguments:
        - "-d"
        - "$(var rviz_config_file)"
